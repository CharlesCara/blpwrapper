EXAMPLES_DIRECTORY = "/private/tmp/569/C/work/rbloomberg-examples/"

# Webby configuration
SITE.output_dir = '../www/'
SITE.create_mode = 'directory'

# Webby (rake) tasks
task :default => :pdf

task :clobber do
  raise "Clobber not available, breaks SVN."
end

task :run_examples do
  # Export the examples directory to Windows VM or other R-accessible directory specified by EXAMPLES_DIRECTORY
  `cp content/examples/* #{EXAMPLES_DIRECTORY}`
  
  # Strip out any Idiopidae comment lines so they don't get executed.
  # They do no harm if they are executed, but they clutter up output.
  `ls #{EXAMPLES_DIRECTORY}/*.R`.chomp.split.each do |f|
    data = File.read(f)
    data = data.gsub(/^\#\#\#.*$\n/, "")
    
    File.open(f, "w") do |file|
      file.write data
    end
  end
  
  # TODO automatically run examples
  puts "files exported, now run them in R"
end
# 
# result = `ps ux | awk '/prl_vm_app/ && !/awk/ {print $2}'`.chomp
# 
# puts "Parallels process is #{result}..."
# 
# system %{
# cp -r pkg /private/tmp/#{result}/C/work/rbloomberg-trunk
# }
