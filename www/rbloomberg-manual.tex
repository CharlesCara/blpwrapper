\documentclass[a4paper]{article}
\usepackage{fullpage}
\usepackage{fancyvrb}
\usepackage{color}
\usepackage[ascii]{inputenc}
\usepackage{hyperref}
\usepackage[pdftex]{graphicx}
\usepackage{wrapfig}
\usepackage{multicol}

\newcommand\at{@}
\newcommand\lb{[}
\newcommand\rb{]}
\newcommand\PYbg[1]{\textcolor[rgb]{0.00,0.50,0.00}{\textbf{#1}}}
\newcommand\PYbf[1]{\textcolor[rgb]{0.73,0.40,0.53}{\textbf{#1}}}
\newcommand\PYbe[1]{\textcolor[rgb]{0.82,0.25,0.23}{\textbf{#1}}}
\newcommand\PYbd[1]{\textcolor[rgb]{0.40,0.40,0.40}{#1}}
\newcommand\PYbc[1]{\textcolor[rgb]{0.73,0.13,0.13}{#1}}
\newcommand\PYbb[1]{\textcolor[rgb]{0.00,0.50,0.00}{#1}}
\newcommand\PYba[1]{\textcolor[rgb]{0.00,0.00,0.50}{\textbf{#1}}}
\newcommand\PYaJ[1]{\textcolor[rgb]{0.69,0.00,0.25}{#1}}
\newcommand\PYaK[1]{\textcolor[rgb]{0.73,0.13,0.13}{#1}}
\newcommand\PYaH[1]{\textcolor[rgb]{0.50,0.00,0.50}{\textbf{#1}}}
\newcommand\PYaI[1]{\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{#1}}
\newcommand\PYaN[1]{\textcolor[rgb]{0.74,0.48,0.00}{#1}}
\newcommand\PYaO[1]{\textcolor[rgb]{0.00,0.00,1.00}{\textbf{#1}}}
\newcommand\PYaL[1]{\textcolor[rgb]{0.00,0.00,1.00}{#1}}
\newcommand\PYaM[1]{\textcolor[rgb]{0.73,0.73,0.73}{#1}}
\newcommand\PYaB[1]{\textcolor[rgb]{0.73,0.13,0.13}{#1}}
\newcommand\PYaC[1]{\textcolor[rgb]{0.67,0.13,1.00}{#1}}
\newcommand\PYaA[1]{\textcolor[rgb]{0.00,0.50,0.00}{#1}}
\newcommand\PYaF[1]{\textcolor[rgb]{0.63,0.00,0.00}{#1}}
\newcommand\PYaG[1]{\textcolor[rgb]{1.00,0.00,0.00}{#1}}
\newcommand\PYaD[1]{\textcolor[rgb]{0.00,0.50,0.00}{\textbf{#1}}}
\newcommand\PYaE[1]{\textcolor[rgb]{0.25,0.50,0.50}{\textit{#1}}}
\newcommand\PYaZ[1]{\textcolor[rgb]{0.00,0.50,0.00}{\textbf{#1}}}
\newcommand\PYaX[1]{\textcolor[rgb]{0.00,0.50,0.00}{#1}}
\newcommand\PYaY[1]{\textcolor[rgb]{0.73,0.13,0.13}{#1}}
\newcommand\PYaR[1]{\textcolor[rgb]{0.40,0.40,0.40}{#1}}
\newcommand\PYaS[1]{\textcolor[rgb]{0.10,0.09,0.49}{#1}}
\newcommand\PYaP[1]{\textcolor[rgb]{0.00,0.00,0.50}{\textbf{#1}}}
\newcommand\PYaQ[1]{\textcolor[rgb]{0.49,0.56,0.16}{#1}}
\newcommand\PYaV[1]{\textcolor[rgb]{0.00,0.00,1.00}{\textbf{#1}}}
\newcommand\PYaW[1]{\textcolor[rgb]{0.73,0.13,0.13}{#1}}
\newcommand\PYaT[1]{\textcolor[rgb]{0.40,0.40,0.40}{#1}}
\newcommand\PYaU[1]{\textcolor[rgb]{0.25,0.50,0.50}{\textit{#1}}}
\newcommand\PYaj[1]{\textcolor[rgb]{0.00,0.50,0.00}{#1}}
\newcommand\PYak[1]{\textcolor[rgb]{0.73,0.40,0.53}{#1}}
\newcommand\PYah[1]{\textcolor[rgb]{0.63,0.63,0.00}{#1}}
\newcommand\PYai[1]{\textcolor[rgb]{0.10,0.09,0.49}{#1}}
\newcommand\PYan[1]{\textcolor[rgb]{0.40,0.40,0.40}{#1}}
\newcommand\PYao[1]{\textcolor[rgb]{0.73,0.40,0.13}{\textbf{#1}}}
\newcommand\PYal[1]{\textcolor[rgb]{0.25,0.50,0.50}{\textit{#1}}}
\newcommand\PYam[1]{\textbf{#1}}
\newcommand\PYab[1]{\textit{#1}}
\newcommand\PYac[1]{\textcolor[rgb]{0.73,0.13,0.13}{#1}}
\newcommand\PYaa[1]{\textcolor[rgb]{0.50,0.50,0.50}{#1}}
\newcommand\PYaf[1]{\textcolor[rgb]{0.25,0.50,0.50}{\textit{#1}}}
\newcommand\PYag[1]{\textcolor[rgb]{0.40,0.40,0.40}{#1}}
\newcommand\PYad[1]{\textcolor[rgb]{0.00,0.25,0.82}{#1}}
\newcommand\PYae[1]{\textcolor[rgb]{0.40,0.40,0.40}{#1}}
\newcommand\PYaz[1]{\textcolor[rgb]{0.00,0.63,0.00}{#1}}
\newcommand\PYax[1]{\textcolor[rgb]{0.60,0.60,0.60}{\textbf{#1}}}
\newcommand\PYay[1]{\textcolor[rgb]{0.00,0.50,0.00}{\textbf{#1}}}
\newcommand\PYar[1]{\textcolor[rgb]{0.10,0.09,0.49}{#1}}
\newcommand\PYas[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{#1}}}
\newcommand\PYap[1]{\textcolor[rgb]{0.00,0.50,0.00}{\textbf{#1}}}
\newcommand\PYaq[1]{\textcolor[rgb]{0.53,0.00,0.00}{#1}}
\newcommand\PYav[1]{\textcolor[rgb]{0.67,0.13,1.00}{\textbf{#1}}}
\newcommand\PYaw[1]{\textcolor[rgb]{0.40,0.40,0.40}{#1}}
\newcommand\PYat[1]{\textcolor[rgb]{0.10,0.09,0.49}{#1}}
\newcommand\PYau[1]{\textcolor[rgb]{0.10,0.09,0.49}{#1}}



\title{RBloomberg Manual}
\author{Ana Nelson}

\begin{document}

\maketitle


\section{About RBloomberg} % (fold)
\label{sec:about}

RBloomberg is an R package which handles fetching data from the Bloomberg financial data application. RBloomberg was written by Robert Sams, see the package README for additional contributors and acknowledgements. RBloomberg is released under a GPL open source license.

% section about (end)

\section{Installation and Requirements} % (fold)
\label{sec:installation_and_requirements}

\subsection{Installation} % (fold)
\label{sub:installation}

RBloomberg will only work on a Bloomberg workstation, using the Desktop COM API. This version requires the rcom R package, which in turn depends on \href{http://rcom.univie.ac.at/}{statconnDCOM} which is a COM server that, while free, is not open source. Support for the Bloomberg Version 3 Java API is in development. When rcom is installed, it will give instructions on how to install statconnDCOM. If you install RBloomberg via

\begin{verbatim}
  install.packages("RBloomberg", repos="http://R-Forge.R-project.org")
\end{verbatim}

then rcom will automatically be installed for you if you don't have it.

% subsection installation (end)

\subsection{Hello, World} % (fold)
\label{sub:hello_world}

Once you have RBloomberg installed, load the library just like any other via:

\begin{Verbatim}[commandchars=@\[\],numbers=left,firstnumber=1,stepnumber=1]
library(RBloomberg)
\end{Verbatim}

    

The first order of business is to connect to the Bloomberg data application, and store a reference to this connection object. You will use this in all subsequent calls:

\begin{Verbatim}[commandchars=@\[\],numbers=left,firstnumber=2,stepnumber=1]
conn @PYbd[<-] blpConnect()
\end{Verbatim}

    

Then we can make a simple request to ensure that the connection is working:

\begin{Verbatim}[commandchars=@\[\],numbers=left,firstnumber=3,stepnumber=1]
blpGetData(conn, @PYaB["]@PYaB[RYA ID Equity"], @PYaB["]@PYaB[NAME"])
\end{Verbatim}

    

The result of running these three commands should be something like this:

\begin{Verbatim}[commandchars=@\[\],numbers=left,firstnumber=1,stepnumber=1]
> library(RBloomberg)
Loading required package: rcom
Loading required package: rscproxy
Loading required package: zoo

Attaching package: 'zoo'


	The following object(s) are masked from package:base :

	 as.Date.numeric 

Loading required package: bitops
Loading required package: RUnit
Contents of bbfields have been stored in .bbfields in the current workspace
Contents of bbfields.ovr have been stored in .ovr in the current workspace
> conn <- blpConnect()
> blpGetData(conn, "RYA ID Equity", "NAME")
                              NAME
RYA ID EQUITY RYANAIR HOLDINGS PLC
> 
\end{Verbatim}

    

% subsection hello_world (end)

\subsection{Unit Tests} % (fold)
\label{sub:unit_tests}

Tests are live code examples that are tested for the expected output. They are useful to developers as a code quality tool, and they can also be very useful to users to help ensure everything is running smoothly and also as an extra source of reference material. Should you not be able to find the information you need in formal documentation (this is general advice, not just pertaining to RBloomberg), look for tests and study the syntax of examples there.

To ensure that everything is running smoothly, we recommend that you run the RUnit test suite:

\begin{Verbatim}[commandchars=@\[\],numbers=left,firstnumber=2,stepnumber=1]
testResults @PYbd[<-] runTestSuite(allBloombergTests)
printTextProtocol(testResults)
\end{Verbatim}

    

The output of printTextProtocol should look like this:

\begin{Verbatim}[commandchars=@\[\],numbers=left,firstnumber=1,stepnumber=1]
RUNIT TEST PROTOCOL -- Tue Jun 23 16:53:54 2009 
*********************************************** 
Number of test functions: 14 
Number of errors: 0 
Number of failures: 0 

 
1 Test Suite : 
All Tests - 14 test functions, 0 errors, 0 failures



Details 
*************************** 
Test Suite: All Tests 
Test function regexp: ^test.+ 
Test file regexp: Test.R$ 
Involved directory: 
C:/DOCUME~1/nelsona/LOCALS~1/Temp/Rinst109275280/RBloomberg/runit-tests 
--------------------------- 
Test file: C:/DOCUME~1/nelsona/LOCALS~1/Temp/Rinst109275280/RBloomberg/runit-tests/blpGetDataTest.R 
test.basic: (2 checks) ... OK (2.01 seconds)
test.overrides: (9 checks) ... OK (2.16 seconds)
--------------------------- 
Test file: C:/DOCUME~1/nelsona/LOCALS~1/Temp/Rinst109275280/RBloomberg/runit-tests/blpToolsTest.R 
test.category.name: (1 checks) ... OK (0.03 seconds)
test.data.type.for.list.of.fields: (1 checks) ... OK (0.01 seconds)
test.data.type.for.single.field: (1 checks) ... OK (0 seconds)
test.field.info.raises.error.on.invalid.mnemonic: (1 checks) ... OK (0 seconds)
test.field.name.for.list.of.fields: (1 checks) ... OK (0.03 seconds)
test.field.name.for.single.field: (1 checks) ... OK (0.01 seconds)
test.historical: (1 checks) ... OK (0 seconds)
test.is.power.of.two: (4 checks) ... OK (0 seconds)
test.static: (1 checks) ... OK (0.02 seconds)
test.what.i.override: (2 checks) ... OK (0 seconds)
test.what.overides.me: (2 checks) ... OK (0.02 seconds)
--------------------------- 
Test file: C:/DOCUME~1/nelsona/LOCALS~1/Temp/Rinst109275280/RBloomberg/runit-tests/rcomBloombergTest.R 
test.bloomberg: (3 checks) ... OK (3.3 seconds)
\end{Verbatim}

    

In particular, take note of any errors or failures. Hopefully you will have none of either.

% subsection unit_tests (end)

% section installation_and_requirements (end)

\section{Getting Current Data} % (fold)
\label{sec:getting_current_data}

This section covers getting current, i.e. non-historical, data from Bloomberg. This may be live (or delayed as per your availability) market data, or static descriptive data.

Note that the fields employed here are the same fields you may be familiar with using the Excel add-in, and the FLDS function within your Bloomberg terminal is a convenient way to search for fields.

\subsection{Basic Calls} % (fold)
\label{sub:basic_calls}

You have already seen the simplest type of call you can make. At minimum we need to pass a connection object, a single ticker, and a single field.

\begin{Verbatim}[commandchars=@\[\],numbers=left,firstnumber=5,stepnumber=1]
blpGetData(conn, @PYaB["]@PYaB[RYA ID Equity"], @PYaB["]@PYaB[PX_LAST"])
\end{Verbatim}

    

This can be expanded by passing vectors of tickers and/or fields, to obtain data on multiple securities at once, or to return multiple fields at once, or both.

\begin{Verbatim}[commandchars=@\[\],numbers=left,firstnumber=6,stepnumber=1]
blpGetData(conn, c(@PYaB["]@PYaB[IBM US Equity"], @PYaB["]@PYaB[MSFT US Equity"]), c(@PYaB["]@PYaB[NAME"], @PYaB["]@PYaB[PX_LAST"]))
\end{Verbatim}

    

And, of course, you can pass these arguments by way of variables, just as you might for any other R function:

\begin{Verbatim}[commandchars=@\[\],numbers=left,firstnumber=7,stepnumber=1]
securities @PYbd[<-] @PYaB["]@PYaB[ED1 Comdty"]
fields @PYbd[<-] c(@PYaB["]@PYaB[NAME"], @PYaB["]@PYaB[PX_LAST"], @PYaB["]@PYaB[OPEN"])
blpGetData(conn, securities, fields)
\end{Verbatim}

    

The data returned from these calls will look something like this:

\begin{Verbatim}[commandchars=@\[\],numbers=left,firstnumber=1,stepnumber=1]
              PX_LAST
RYA ID EQUITY   3.168
                                      NAME PX_LAST
IBM US EQUITY  INTL BUSINESS MACHINES CORP 104.453
MSFT US EQUITY              MICROSOFT CORP  23.550
                              NAME PX_LAST  OPEN
ED1 COMDTY Generic 1st 'ED' Future   99.26 99.25
\end{Verbatim}

    

% subsection basic_calls (end)

\subsection{Using Overrides} % (fold)
\label{sub:using_overrides}

The Bloomberg API allows you to make certain overrides to change the value that a function returns. We give a few examples here, to determine whether a field you wish to request can be overridden, consult the FLDS screen in your Bloomberg terminal (look for What Overrides Me), or use the what.overrides.me() function discussed below to look up overrides within R.

A common use for overrides is to return data in a currency other than the security's default currency.

\begin{Verbatim}[commandchars=@\[\],numbers=left,firstnumber=5,stepnumber=1]
blpGetData(conn, @PYaB["]@PYaB[RYA ID Equity"], @PYaB["]@PYaB[PX_LAST"])
blpGetData(conn, @PYaB["]@PYaB[RYA ID Equity"], @PYaB["]@PYaB[CRNCY_ADJ_PX_LAST"])

blpGetData(conn, @PYaB["]@PYaB[RYA ID Equity"], @PYaB["]@PYaB[CRNCY_ADJ_PX_LAST"], 
   override_fields @PYbd[=] @PYaB["]@PYaB[EQY_FUND_CRNCY"], overrides @PYbd[=] @PYaB["]@PYaB[HKD"])

blpGetData(conn, @PYaB["]@PYaB[RYA ID Equity"], @PYaB["]@PYaB[CRNCY_ADJ_PX_LAST"], 
   override_fields @PYbd[=] @PYaB["]@PYaB[EQY_FUND_CRNCY"], overrides @PYbd[=] @PYaB["]@PYaB[GBP"])
\end{Verbatim}

    

\begin{Verbatim}[commandchars=@\[\],numbers=left,firstnumber=1,stepnumber=1]
              PX_LAST
RYA ID EQUITY   3.168
              CRNCY_ADJ_PX_LAST
RYA ID EQUITY             3.168
              CRNCY_ADJ_PX_LAST
RYA ID EQUITY          34.44668
              CRNCY_ADJ_PX_LAST
RYA ID EQUITY          2.719388
\end{Verbatim}

    

Another very useful function involving overrides is the Custom Total Return family of calls. We can first use some of the helper functions to find the tickers by searching the list of available mnemonics, and to determine which overrides are available and which fields they apply to.

\begin{Verbatim}[commandchars=@\[\],numbers=left,firstnumber=17,stepnumber=1]
cat(@PYaB["]@PYaB[search all mnemonics to find all with CUST_TRR\n"])
search.mnemonics(@PYaB["]@PYaB[CUST_TRR"])

cat(@PYaB["]@PYaB[find out which fields override CUST_TRR_RETURN\n"])
what.overrides.me(@PYaB["]@PYaB[CUST_TRR_RETURN"])

cat(@PYaB["]@PYaB[find our which fields are overridden by CUST_TRR_CRNCY\n"])
what.i.override(@PYaB["]@PYaB[CUST_TRR_CRNCY"])
\end{Verbatim}

    

\begin{Verbatim}[commandchars=@\[\],numbers=left,firstnumber=1,stepnumber=1]
search all mnemonics to find all with CUST_TRR
@lb[]1@rb[] "CUST_TRR_DVD_TYP"            "CUST_TRR_START_DT"          
@lb[]3@rb[] "CUST_TRR_END_DT"             "CUST_TRR_CRNCY"             
@lb[]5@rb[] "CUST_TRR_RETURN_ANNUALIZED"  "CUST_TRR_RETURN_HOLDING_PER"
@lb[]7@rb[] "CUST_TRR_RETURN"            
find out which fields override CUST_TRR_RETURN
@lb[]1@rb[] "CUST_TRR_DVD_TYP"  "CUST_TRR_START_DT" "CUST_TRR_END_DT"  
@lb[]4@rb[] "CUST_TRR_CRNCY"   
find our which fields are overridden by CUST_TRR_CRNCY
@lb[]1@rb[] "CUST_TRR_RETURN_ANNUALIZED"  "CUST_TRR_RETURN_HOLDING_PER"
\end{Verbatim}

    

Once we know the fields, we can construct our call to fetch the desired data:

\begin{Verbatim}[commandchars=@\[\],numbers=left,firstnumber=28,stepnumber=1]
blpGetData(conn, @PYaB["]@PYaB[MSFT US Equity"], 
   c(@PYaB["]@PYaB[CUST_TRR_RETURN"]), 
   override_fields @PYbd[=] c(@PYaB["]@PYaB[CUST_TRR_START_DT"], @PYaB["]@PYaB[CUST_TRR_END_DT"], 
   overrides @PYbd[=] c(@PYaB["]@PYaB[20080215"], @PYaB["]@PYaB[20080602"])
)

blpGetData(conn, @PYaB["]@PYaB[MSFT US Equity"], 
   c(@PYaB["]@PYaB[CUST_TRR_RETURN"]), 
   override_fields @PYbd[=] c(@PYaB["]@PYaB[CUST_TRR_START_DT"], @PYaB["]@PYaB[CUST_TRR_END_DT"], @PYaB["]@PYaB[CUST_TRR_CRNCY"]), 
   overrides @PYbd[=] c(@PYaB["]@PYaB[20080215"], @PYaB["]@PYaB[20080602"], @PYaB["]@PYaB[GBP"])
)
\end{Verbatim}

    

\begin{Verbatim}[commandchars=@\[\],numbers=left,firstnumber=1,stepnumber=1]

\end{Verbatim}

    


% subsection using_overrides (end)

% section getting_current_data (end)


\end{document}
